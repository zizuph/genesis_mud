----- The Ship -----
- by Groo 90-05-21 -
--------------------

The ship is a generic object for ferry tours between domains in particular
and will hopefully be able to do whatever you want it to with no changes as
the main concern has been to make it usable in many different situations.
It moves about on a certain, predefined route and calls a function in a room
when leaving it and another function in the room where it arrives, letting the
rooms decide what is going to happen next. 

The ship calls a 'sail_away' function with regular intervals (the actual name is
 longer than that but I'll call it 'sail_away' here for convenience..)  ;)
and every time this function is called, the variable 'call_no' is decreased 
and upon its reaching zero the ship will move on to the next location
as specified in the 'places_to_go' array which holds a number of filenames
for rooms where the ship is to go. 
I'll give a short explanation of the main variables that are used by the ship :

int call_no
-----------
Every time 'sail_away' is called, this variable is decreased and when it reaches
zero or less, the ship will move on to the next location, adding one to the
'location' integer variable and if that is then greater than the number of locations
specified in 'places_to_go' it will be set to zero. Then the ship will be moved
to places_to_go[location] and 'call_no' will be set to the value of the variable
time_between_stops[location.

int callout_fq
--------------
This is the number of seconds between each call_out to the 'sail_away' function.
This means the actual time, measured in seconds, before the ship moves from
location x to location x+1 is 'time_between_stops[x] * callout_fq'.

string places_to_go
-------------------
This is an array holding any number of filename strings that are the rooms the ship
is to visit, each in the order they're defined in the array. If you want the ship
to go from x to y to x to z for example you'll have to put 'x' in the array twice.
An example of how this array might look like is :
call_other(ship, "set_places_to_go", ({ "room/church", "room/yard", "room/pub2" }));
This LPC call would result in the ship visiting three places in the village
(maybe not the right places for a ship though). 
If the error logging is on, the ship will when it's started check each string in
'places_to_go' to see if the object exists and is loaded. If it isn't - the ship
will try and load the room and then check again and if that fails, the ship will
exit the start procedure with an error message in the logfile.

int time_between_stops
----------------------
This is another array containing one integer element for each place specified
in 'places_to_go' and if we have 5 locations to visit, then the integer element
time_between_stops[3] is the number of times the 'sail_away' function will be
called before the ship moves on from places_to_go[3] to places_to_go[4].
Let's say we've specified 'callout_fq' as 5 and we have set the 'places_to_go'
variable as we did in the above example, making the ship visit the church, yard
and pub in the village - Then the time between the ship arriving at the church
and the ship leaving for the yard would be equal to :
callout_fq * time_between_stops[0]
When you set this array variable with the provided function 'set_time_between_stops'
you may call it with a single integer instead of a whole array and the whole
'time_between_stops' array will automatically get the right size and all elements
will be set to the value you specified, making the ship stay exactly the same
amount of time at every location.

int event_enable
----------------
This variable is for enabling/disabling events. If you set it to zero (0)
no events will be generated. If it is set to a nonzero value, events will
be randomly called if they have been specified in the 'events' array.

string events
-------------
This is an array holding information on possible events. Events are things
that may happen while the ship is out sailing and they will be randomly
generated by the ship depending on the ships location, the event_enable
flag etc. It works like this :
Let's say we did these calls :
set_event_enable(1);
set_events( ({ 0, 2, 100, "players/groo/the_event", "start_event" }) );
The first call would set the variable 'event_enable' to 1 and thus enabling
events in general. The second call would result in the ship, each time the
'sail_away' function is called (that is, every 'callout_fq' seconds) check
if the ships' 'location' variable is 0..2 (0,1 or 2) and if it is, generate
a random number between 1 and 1000 and then comparing that number to 100 which
we specified in the 'events' array. If the number was equal to or lower than 100
the ship would call the function "start_event" in the object "players/groo/the_event"
sending this_object() (the ship) as an argument. After that, the ship would make
sure no further calls to the 'sail_away' function were issued, effectively
pausing the ship's movement so that the event whatever it may be can take place
undisturbed. When the event has finished its business it should call the 'sail_away'
function to start the ship again.
Several events can be defined by making each event an array within the 'events' array.
Example :
set_events( ({ ({ 0, 2, 100, "players/groo/the_event", "start_event" }),
               ({ 2, 4, 200, "players/groo/the_other_event", "start_event" })
            }) );
If we had set 'event_enable' to 1 and started the ship on a route with, say 6 
locations, it would :
at location 0 and 1 : Generate a random number (1-1000) and compare it to 100 and
                      possibly call "start_event" in "players/groo/the_event".
at location 2 : First generate a random number to compare with 100 and maybe call
                the first event - if the random number is higher than 100, a new
                random number will be created and compared to 200 which is the event
                chance for the second event. This means only one event will be called
                by the ship at one time and events defined in the beginning of the 
                'events' array will be checked for first.
at location 3 and 4 : Generate random number to compare with 200 only as these
                      locations have been defined in the second events' array only.

string deck
-----------
This is a filename string for the ships' deck. The deck is where the players boarding
the ship will go and when the ship arrives at or leaves any location it will
try to call the functions 'ship_arrives' and 'ship_left' in the deck so that
the deck can perform any necessary actions when the ship moves. Like informing
the players on the deck something like 'The ship arrives at a new destination'
or something similiar.

object captain
--------------
If the captain object is defined the ship will try to call a function named
'query_land' in each room it comes to and if that function should return a
nonzero value, the ship will move the captain object outside the ship to maybe
sell tickets to people and/or stopping people without tickets from boarding the
ship. (You decide what you want to do with your captain if you choose to use one).

int location
------------
This variable tells us where we are. If not set to something else in the beginning
it will be zero (0) when the ship starts and increased by one (1) each time 
'call_no' <= 0. The current position of the ship is places_to_go[location] thus.

int board_enabled
-----------------
The ship defines a board() command for players outside it if desired. 
The function can be disabled/enabled by manipulating this flag. If the variable
is a nonzero value, the 'board ship', 'enter ship' and 'embark' commands will
be accepted and the ship will then check for tickets etc if that has been defined.
If everything's ok, the player will be moved to the ship's deck.

string short_desc
-----------------
The short description of the ship as seen by players in the same room as
the ship. People on the ship won't see this as they're not really on the
ship but 'in' the deck room.

string long_desc
----------------
This is what people get upon examining the ship from the outside.

string ticket_file
------------------
This is a string filename for a ticket object that, if it is defined,
will be sold by the ship. You may want to make it so that your captain
monster is selling the tickets and to do that you just have to define
a living monster as the captain object.

string ticket_id
----------------
This is a special id string that will make sure you get the right ticket
from a player that wants to travel by your ship. Set this variable to 
something that will cause it not to be mixed up with some other ticket
object. The ship will only let players with a ticket answering to this 
id board it. In my sample ticket I set the ticket id to 
"liwitch island line" which is of course a bad idea as the liwitch people
may well use the same string..;)  Seriously it's that kind of strings 
that should be used as the chance of a mixup is very small.
If 'ticket_id' isn't defined, the ship will admit anyone regardless if
they've got tickets or not.

string id_strings
-----------------
This is either a string or an array of strings. It is the accepted id's for
the ship and it could look like this :
id_strings = ({ "ship", "the ship", "magnificent ship", "liwitch ship" });
This would make the ship's id() function return true (1) on all these
strings. 'id_strings' may also be set to a single string if so desired.
(Ps. This is how ALL generic objects should handle their id's...)


If you need more information - look at the code because it is commented
a lot in the beginning where the variables are declared. If that's not
enough ask or mail Groo.
Also, any suggestions regarding improvements and/or changes will be 
gladly accepted!
/Groo
